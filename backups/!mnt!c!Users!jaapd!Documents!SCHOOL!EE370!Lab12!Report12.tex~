% Created 2017-12-04 Mon 14:18
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage[margin=1.01in]{geometry}
\author{Jaap de Dood}
\date{November 20 2017}
\title{EE370 Lab12\\\medskip
\large Instructor: Paula Quintana}
\hypersetup{
 pdfauthor={Jaap de Dood},
 pdftitle={EE370 Lab12},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 24.5.1 (Org mode 9.0.7)}, 
 pdflang={English}}
\begin{document}

\maketitle
\section{Activity 3}
\label{sec:orgc7426a5}
In this activity, the same circuit and code as the previous lab were used but this time the effects of altering the gain constants were observed.
\begin{center}
\includegraphics[width=.9\linewidth]{image1.jpg}
\end{center}
Kp, the gain of the proportional band was changed from 1 to 0.5, 1.0, 2.0 and on the last run 0.1 with the band at 5. There is some substantial noise in the circuit when the fan is turned on. This should be ignored. There is no overshoot in this response but diffirence in output drives can be seen in the graphs in blue. As the Kp was increased each time, the output remained at 100$\backslash$% for a longer time. At a Kp of 0.1 the output never even reached 100$\backslash$% but stayed at approximately 60$\backslash$% for the duration of the plot. In fact, the temperature never reached the setpoint in almost 10 minutes time, although approaching it asymptotically. This means a Kp of 0.1 is creates a very overdamped system. As none of the responses caused any overshoot anyway, the system with a kp = 2.0 produced the best response as it approached the setpoint fastest.
\subsection{If the error is negative, will this reduce or increase the total drive controlling the system?}
\label{sec:orgf78162b}
If the error is negative, this means the measured value is above the setpoint thus the drive will be reduced to decrease the measurement.
\subsection{What is the “Band of Temperature Control” and how does this value affect the “proportional drive” applied to the system? To do this you can compare a Band Temperature of 1F and a Band of 2F. If the error is 0.3F, what’s the percentage of proportional drive applied in both cases(Assuming Kp=1)?}
\label{sec:org2b34968}
The band of temperature control sets the range of acceptable temperatures. A larger band of temperature control will allow for more variation in temperature as the calculated error will be less. For example, a temperature error of 0.3 F with a band temperature of 1F will cause
\[\%Error=0.3/1 F x100\% = 30\%\]
and a temperature band of 2F with error 0.5 F will cause
\[\%Error=0.3/2 F x100\% = 15\%\]
So with the same magnitude of error, the percentage error will be less and so the drive applied will be less too.
\section{Challenge 8-3}
\label{sec:orgac7afe2}
\begin{center}
\includegraphics[width=200px]{image2.jpg}
\end{center}
Proportional Gain = 1/200\(\%\) = 0.5\newline\newline
Output at: 111F = 37.5\(\%\), 106F = 100\(\%\), 115F = 0\(\%\).
\section{Activity 4}
\label{sec:org8e4e2bb}
In this activity, the setpoint was set a further distance away from the stable 50\% bias temperature. Now, with a Kp of 0.1, the temperature stabilized around 100 F, which is a significant steady state error from the setpoint ot 105 F. By increasing the proportional gain, Kp, the drive proportional to the error was increased and so a temperature closer to the setpoint was achieved.
\begin{center}
\includegraphics[width=200px]{image3.jpg}
\end{center}
Even at kp = 2.0, with a fully charged battery, there was no oscillation so 2.0 would be the best value for Kp. The bias drive cannot be adjusted manually like this to account for large errors. This is why proportional drive alone is not enough to keep the system at a stable temperature regardless of the conditions.
\section{Challenge 8-4}
\label{sec:org47889e5}
\begin{enumerate}
\item Below the setpoint. 50\% is not enough to drive the flow to the setpoint.
\item Increasing the proportional gain will increase the steady state flow rate but an excessive gain will cause oscillation.
\item Decreasing the proportional gain will decrease the drive and cause larger error.
\end{enumerate}
\section{Activity 5}
\label{sec:orga72545e}
In this activity, using integral drive to correct for long-lasting errors was investigated. 
\begin{center}
\includegraphics[width=400px]{image4.jpg}
\end{center}
The blue output graphs shows how the integral was being calculated correctly as the integral gain, Ki, was increased, but the temperature graph does not look exactly as expected. This is because the integral drive quickly reaches 100\% and cannot exceed this, so the temperature only increases faster with a higher gain for a few seconds as the integral drive reaches 100\% but is the same after that. Nonetheless, it can be seen that the integral increases at a much higher rate when the gain is increased so the system would behave as expected with a higher drive capacity.
\section{Challenge 8-5}
\label{sec:org709ab3f}
\begin{center}
\includegraphics[width=400px]{image5.jpg}
\end{center}
In this plot, only integral control was used. As can be seen, this works but is not very effectevie as there is huge over and undershoot. This is because the integral value stays positive or negative for a long time after passing the setpoint before it turns the opposite direction. This causes oscillation.
\section{Activity 6}
\label{sec:org8a4c738}
In this activity, the derivative component of PID control was investigated. The following plot was produced by increasing the derivative gain constant, Kd, from 0 to 1, 10 and 50 and introducing disturbances to the system.
\begin{center}
\includegraphics[width=400px]{image6.jpg}
\end{center}
It is not that clear to see in the plot, partially because the setpoint was set a little too high, but with only proportional control there is some oscillation in the temperature after it reaches the setpoint. With the derivative gain increased, this oscillation is reduced as changes in temperature are resisted. At Kd = 50, this is excessive and the temperature oscillates without even reaching the setpoint.
\section{Challenge 8-6}
\label{sec:orgc659ba5}
In this challenge, it was tested whether a system could be controlled using only derivative control.
\begin{center}
\includegraphics[width=400px]{image7.jpg}
\end{center}
The plot shows the answer is clearly no. As the temperature slowly decreased the derivative drive was not sufficient to compensate for the energy loss. Even with a higher derivative gain, if the temperature is not the setpoint, it will remain the same as long as there is no change in temperature.
\section{Final Lab}
\label{sec:orgc35efe1}
In this lab, a PID system was tuned to provide the best responses for different requirements. First, a setpoint of 101.5 F +/- 1 F with a bias of 50\% and drive time of 2 seconds was used and the system was tuned until the fastest response with minimal error was seen. The following plots are a recording of the process.
\begin{center}
\includegraphics[width=400px]{image7b.jpg}
\end{center}
\begin{center}
\includegraphics[width=400px]{image8.jpg}
\end{center}
\begin{center}
\includegraphics[width=200px]{image9.jpg}
\end{center}
The last plot shows the system responding to a heavy disurbance by a fan. The temperature quickly returns to the setpoint with no overshoot. \newline\newline
The same process was repeated with a setpoint of 100F +/- 2F with a 50\% bias and drive time of 1 second.
\begin{center}
\includegraphics[width=400px]{image10.jpg}
\end{center}
\section{MATLAB}
\label{sec:org4c6e8e8}
Using Simulink, the following model was constructed:
\begin{center}
\includegraphics[width=.9\linewidth]{image11.jpg}
\end{center}
Appropriate gain values were estimated using the results seen in lab. The gains initially used, Kp=1, Ki = 0.001, Kp=1 produced the following response:
\begin{center}
\includegraphics[width=300px]{image12.jpg}
\end{center}
Where the yellow line is the output drive and the blue line is the "temperature". This shows a fast response but with significant overshoot. To reduce the overshoot the derivative gain, Kd, was increased until a good response was seen. This was at Kd = 3, which produces the following response:
\begin{center}
\includegraphics[width=300px]{image13.jpg}
\end{center}
This seems like a fast response with no overshoot. To further test the system, the initial conditions were altered to observe the response. With an initial temperature of 50 F, the system still shows a fast response with no obvious overshoot.
\begin{center}
\includegraphics[width=300px]{image14.jpg}
\end{center}
\end{document}